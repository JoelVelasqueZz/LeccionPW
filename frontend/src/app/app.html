<div class="container">
  <!-- Encabezado -->
  <header class="header">
    <h1>{{ title }}</h1>
    <p>GestiÃ³n de Rutas y Unidades de Transporte</p>
  </header>

  <!-- Mensajes de estado -->
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>

  <div *ngIf="error" class="alert alert-error">
    {{ error }}
  </div>

  <!-- Formulario para agregar rutas -->
  <div class="form-container">
    <h2>ğŸ“ Agregar Nueva Ruta</h2>
    
    <form [formGroup]="rutaForm" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <div class="form-group">
          <label for="origen">Origen:</label>
          <input 
            type="text" 
            id="origen" 
            formControlName="origen"
            placeholder="Ej: Machala"
            [class.invalid]="isFieldInvalid('origen')"
          />
          <span class="error-message" *ngIf="isFieldInvalid('origen')">
            El origen es requerido (mÃ­nimo 3 caracteres)
          </span>
        </div>

        <div class="form-group">
          <label for="destino">Destino:</label>
          <input 
            type="text" 
            id="destino" 
            formControlName="destino"
            placeholder="Ej: Guayaquil"
            [class.invalid]="isFieldInvalid('destino')"
          />
          <span class="error-message" *ngIf="isFieldInvalid('destino')">
            El destino es requerido (mÃ­nimo 3 caracteres)
          </span>
        </div>

        <div class="form-group">
          <label for="unidad_id">Unidad:</label>
          <select 
            id="unidad_id" 
            formControlName="unidad_id"
            [class.invalid]="isFieldInvalid('unidad_id')"
          >
            <option value="">Selecciona una unidad</option>
            <option *ngFor="let unidad of unidades" [value]="unidad.id">
              {{ unidad.placa }} - {{ unidad.chofer }}
            </option>
          </select>
          <span class="error-message" *ngIf="isFieldInvalid('unidad_id')">
            Debes seleccionar una unidad
          </span>
        </div>

        <div class="form-group">
          <button 
            type="submit" 
            class="btn-submit"
            [disabled]="loading || rutaForm.invalid"
          >
            {{ loading ? 'Guardando...' : 'â• Agregar Ruta' }}
          </button>
        </div>
      </div>
    </form>
  </div>

  <!-- Tabla de rutas -->
  <div class="table-container">
    <h2>ğŸ“‹ Rutas Registradas</h2>
    
    <div *ngIf="loading" class="loading">
      Cargando rutas...
    </div>

    <table *ngIf="!loading && rutasCompletas.length > 0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Unidad (Placa)</th>
          <th>Chofer</th>
          <th>Origen</th>
          <th>Destino</th>
          <th>Distancia (km)</th>
          <th>DuraciÃ³n (h)</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ruta of rutasCompletas">
          <td>{{ ruta.id }}</td>
          <td>
            <span class="badge">{{ ruta.unidad?.placa || 'N/A' }}</span>
          </td>
          <td>{{ ruta.unidad?.chofer || 'N/A' }}</td>
          <td>
            <strong>{{ ruta.origen }}</strong>
          </td>
          <td>
            <strong>{{ ruta.destino }}</strong>
          </td>
          <td>
            <span class="distance">
              {{ ruta.distancia_km !== null ? ruta.distancia_km : 'N/A' }}
            </span>
          </td>
          <td>
            <span class="duration">
              {{ ruta.duracion_horas !== null ? ruta.duracion_horas : 'N/A' }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="!loading && rutasCompletas.length === 0" class="empty-state">
      <p>ğŸ“­ No hay rutas registradas</p>
      <p>Agrega tu primera ruta usando el formulario de arriba</p>
    </div>
  </div>
</div>